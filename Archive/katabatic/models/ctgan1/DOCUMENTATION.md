## Project Files Documentation

### `config.json`
- **Purpose:**  
  Stores all configuration parameters for the CT-GAN model, evaluation settings, and visualization preferences.

- **Contents:**  
  ```json
  {
    "ctgan_params": {
      "noise_dim": 128,          # Dimension of the noise vector
      "learning_rate": 0.0002,   # Learning rate for the optimizer
      "batch_size": 500,         # Number of samples per training batch
      "discriminator_steps": 5,  # Number of discriminator updates per generator update
      "epochs": 300,             # Total number of training epochs
      "lambda_gp": 10,           # Gradient penalty coefficient for WGAN-GP
      "pac": 10,                 # Number of minibatches for PacGAN (if applicable)
      "cuda": true,              # Use CUDA for GPU acceleration if available
      "vgm_components": 2        # Number of components in the Gaussian Mixture Model
    },
    "evaluation": {
      "test_size": 0.2,          # Proportion of the dataset to include in the test split
      "random_state": 42         # Seed for random number generator to ensure reproducibility
    },
    "visualization": {
      "n_features": 5,           # Number of features to visualize
      "figsize": [15, 20]        # Size of the visualization figures (width, height)
    } 
  }
  ```

### Python Scripts

#### `ctgan_adapter.py`
- **Purpose:**  
  Implements the `CtganAdapter` class, which serves as an interface for initializing, training, and generating synthetic data using the CT-GAN model.

- **Key Components:**  
  - **Class `CtganAdapter`:**
    - **Initialization:**  
      Sets up the CT-GAN model with specified parameters.
    - **Methods:**
      - `fit(X, y)`: Trains the CT-GAN model on the provided feature matrix `X` and target vector `y`.
      - `generate(n)`: Generates `n` synthetic data samples based on the trained model.

#### `ctgan_benchmark.py`
- **Purpose:**  
  Contains evaluation functions that assess the quality and performance of the synthetic data generated by the CT-GAN model.

- **Key Components:**  
  - **Function `evaluate_ctgan(real_data, synthetic_data)`:**
    - **Purpose:** Computes various evaluation metrics to compare synthetic data against real data.
    - **Arguments:**
      - `real_data (pd.DataFrame)`: The original real dataset.
      - `synthetic_data (pd.DataFrame)`: The synthetic dataset generated by CT-GAN.
    - **Returns:**  
      Dictionary containing all evaluation metrics.
  
  - **Function `print_evaluation_results(results)`:**
    - **Purpose:** Formats and prints the evaluation results in a structured and readable manner.

#### `run_ctgan.py`
- **Purpose:**  
  Automates CT-GAN experiments based on configurations specified in `config.json`. Handles data preprocessing, model training, synthetic data generation, visualization, saving results, and evaluation for multiple datasets.

- **Key Steps:**  
  1. **Configuration Loading:**  
     - Loads parameters from `config.json`.
  
  2. **Data Loading and Preprocessing:**  
     - Loads multiple datasets (iris, breast_cancer, wine, digits).
     - Adjusts batch size based on dataset size.
  
  3. **Model Training:**  
     - Trains the CT-GAN model with specified parameters for each dataset.
  
  4. **Data Generation:**  
     - Generates synthetic data for each dataset.
  
  5. **Visualization:**  
     - Visualizes real vs. synthetic data distributions for each dataset.
  
  6. **Data Saving:**  
     - Saves the synthetic data for each dataset to separate CSV files.
  
  7. **Evaluation:**  
     - Evaluates synthetic data quality for each dataset and logs the results.
     - Computes metrics such as Likelihood Fitness, Statistical Similarity, ML Efficacy, and TSTR Performance.

### `__init__.py`
- **Purpose:**  
  Designates directories as Python packages to enable proper module imports and maintain a clean project structure.

- **Locations:**  
  - `katabatic/__init__.py`
  - `katabatic/models/__init__.py`
  - `katabatic/models/ctgan/__init__.py`

- **Contents:**  
  Typically empty or containing package-level import statements to expose specific classes and functions.

## Running the Experiments

To run the CT-GAN experiments on multiple datasets, use the following command:

```
python -m katabatic.models.ctgan.run_ctgan
```

This command executes the `run_ctgan.py` script, which reads the configuration from `config.json`, loads the specified datasets, trains the CT-GAN model, generates synthetic data, visualizes the results, saves the synthetic data to CSV files, and evaluates the quality of the generated data.

Make sure you have the necessary dependencies installed and are running the command from the correct directory where the `katabatic` package is located.

## Summary of Key Accomplishments

- **Configuration Management:**  
  Centralized CT-GAN parameters, evaluation settings, and visualization preferences in `config.json` for easy adjustments.

- **Model Interface:**  
  Developed the `CtganAdapter` class in `ctgan_adapter.py` to streamline interactions with the CT-GAN model, including training and data generation.

- **Evaluation Framework:**  
  Implemented evaluation functions in `ctgan_benchmark.py` to assess synthetic data quality using metrics like Likelihood Fitness, Statistical Similarity, ML Efficacy, and TSTR Performance.

- **Experiment Automation:**  
  Developed `run_ctgan.py` to automate experiments based on configurations, enhancing scalability and flexibility for multiple datasets (iris, breast_cancer, wine, digits).

- **Project Structuring:**  
  Organized the project with proper package initialization files (`__init__.py`) to ensure seamless module imports and maintain a clean hierarchy.

These components collectively enable the effective training, generation, visualization, and evaluation of synthetic data for multiple datasets using the CT-GAN model within the Katabatic project framework. The automation and evaluation capabilities facilitate comprehensive analysis and comparison of the CT-GAN model's performance across different datasets, providing valuable insights into its efficacy and potential for generating high-quality synthetic data.
